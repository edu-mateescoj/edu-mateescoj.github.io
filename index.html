<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Exerciseur Python avec Brython</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/brython@3.9.5/brython.js"></script>
</head>
<body onload="brython()">

<div class="exercise-container">
    <h2>Exercices automatiques d'assignation de variables (en construction...)</h2>
    <p>Que valent les variables à la fin de l'exécution du code Python ci-dessous ?</p>
    
    <pre id="code-display">Exemple de code</pre>
    
    <label for="v1-answer" id="labelA">Valeur de :</label>
    <input type="text" id="v1-answer" placeholder="Valeur de v1">
    
    <label for="r-answer" id="labelB">Valeur de :</label>
    <input type="text" id="r-answer" placeholder="Valeur de r">
    
    <label for="v3-answer" id="labelC">Valeur de :</label>
    <input type="text" id="v3-answer" placeholder="Valeur de v3">
    
    <button id="verify-button">Vérifier</button>
    <button id="show-button">Montrer les réponses</button>
    <button id="generate-button">Générer un nouvel exercice</button>
</div>

<script type="text/python">
from browser import document

variableNamesWithTypes = {
    'anglais': {
        'age': 'integer',
        # ... inclure ici toutes les autres variables et types
    }
}

currentCorrectAnswers = {}

def generate_dynamic_exercise():
    variableNames = list(variableNamesWithTypes['anglais'].keys())
    selectedVariables = []
    while len(selectedVariables) < 3:
        from random import randint
        randomIndex = randint(0, len(variableNames)-1)
        variable = variableNames[randomIndex]
        if variable not in selectedVariables:
            selectedVariables.append(variable)

    expressions = []
    global currentCorrectAnswers
    currentCorrectAnswers.clear()

    input_ids = ['v1-answer', 'r-answer', 'v3-answer']
    for input_id in input_ids:
        input_element = document[input_id]
        input_element.value = ""
        input_element.style.backgroundColor = ""

    for index, variable in enumerate(selectedVariables):
        value = randint(1, 10)
        expressions.append(f"{variable} = {value}")
        input_id = input_ids[index]
        currentCorrectAnswers[input_id] = str(value)
        label_id = f'label{chr(65+index)}'
        document[input_id].attrs['placeholder'] = f"Valeur de {variable}"
        document[label_id].text = f"Valeur de {variable}:"

    document['code-display'].text = '\n'.join(expressions)

def verify_answers(event):
    answers = {
        'v1-answer': document['v1-answer'].value,
        'r-answer': document['r-answer'].value,
        'v3-answer': document['v3-answer'].value
    }
    
    for input_id, user_answer in answers.items():
        input_element = document[input_id]
        correct_answer = currentCorrectAnswers[input_id]

        if user_answer == "":
            input_element.style.backgroundColor = ""
        elif user_answer == correct_answer:
            input_element.style.backgroundColor = 'lightgreen'
        else:
            input_element.style.backgroundColor = 'salmon'

def show_answers(event):
    # Cette fonction doit être complétée pour afficher les bonnes réponses.
    for input_id, correct_answer in currentCorrectAnswers.items():
        input_element = document[input_id]
        input_element.value = correct_answer
        input_element.style.backgroundColor = 'lightgray'

document['verify-button'].bind('click', verify_answers)
document['show-button'].bind('click', show_answers)
document['generate-button'].bind('click', generate_dynamic_exercise)

generate_dynamic_exercise()
</script>

</body>
</html>
